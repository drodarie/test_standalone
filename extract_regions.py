import numpy as np

id_to_region_dictionary = {}
id_to_region_dictionary_ALLNAME = {}
region_dictionary_to_id = {}
region_dictionary_to_id_ALLNAME = {}
regKeys = []

region_dictionary_to_id_ALLNAME_parent = {}
region_dictionary_to_id_parent = {}
allname2name = {}
name2allname = {}
allnameOrder = {}
region_keys = []
regions_ALLNAME_list = []
is_leaf = []
volDict = {1: 0.03326562500000001, 2: 0.1071875, 3: 0.0, 4: 5.87171875, 6: 2.7903437500000003, 7: 1.130203125, 8: 428.955390625, 9: 0.9693437500000001, 10: 3.47871875, 11: 0.0, 12: 0.036015625, 14: 0.013468750000000002, 15: 0.1428125, 16: 0.0, 17: 0.9294687500000001, 18: 0.0, 19: 0.03746875, 20: 2.133203125, 21: 1.1106875, 22: 3.5568125000000004, 23: 0.6105312500000001, 25: 0.0, 26: 2.332984375, 27: 0.09659375, 28: 1.162546875, 29: 0.0, 30: 0.02753125, 31: 5.2224843750000005, 33: 0.9472812500000001, 34: 0.0, 35: 0.044578125, 36: 0.37462500000000004, 37: 0.0, 38: 0.27139062500000005, 39: 2.7697656250000002, 41: 0.383859375, 42: 0.10900000000000001, 43: 0.0, 44: 1.7934687500000002, 45: 0.10276562500000001, 46: 0.2661875, 47: 0.0, 48: 2.4527187500000003, 49: 0.0, 50: 0.07721875, 51: 1.60321875, 52: 1.3444843750000002, 53: 0.05309375, 54: 0.0, 55: 0.096625, 56: 5.072265625000001, 57: 0.0, 58: 0.0, 59: 0.22775, 60: 0.14615625000000002, 61: 0.06346875, 62: 1.1373125000000002, 63: 0.05321875, 64: 0.170875, 65: 0.0, 66: 0.00971875, 67: 0.046859375, 68: 0.4975, 69: 0.356046875, 70: 0.0, 71: 0.04165625, 72: 0.039703125000000006, 73: 0.0, 74: 0.146515625, 75: 0.0, 76: 0.0, 77: 0.040109375, 78: 2.0064375, 79: 0.009062500000000001, 80: 0.0, 81: 0.0, 82: 0.21684375000000003, 83: 0.5793125, 84: 0.26384375, 85: 0.0, 86: 0.0, 87: 0.079734375, 88: 0.8152343750000001, 89: 0.0, 90: 0.057125, 91: 0.589359375, 92: 0.768484375, 93: 0.18696875000000002, 94: 0.22973437500000002, 95: 4.901734375000001, 96: 0.582015625, 97: 0.628375, 98: 0.0, 99: 0.6015781250000001, 100: 0.305171875, 101: 0.9237031250000001, 102: 0.0, 103: 0.03259375, 104: 2.43790625, 105: 0.051390625, 106: 0.055421875, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.053375000000000006, 111: 1.323859375, 112: 0.044140625, 113: 0.7989843750000001, 114: 0.07521875, 115: 0.010765625000000001, 116: 0.0, 117: 0.39240625, 118: 0.173125, 119: 1.13996875, 120: 0.370515625, 121: 0.037265625000000004, 122: 0.7085312500000001, 123: 0.1595625, 124: 0.0, 125: 0.9178750000000001, 126: 0.12928125000000001, 127: 0.47443750000000007, 128: 6.1228125, 129: 0.0, 130: 0.30107812500000003, 131: 0.612328125, 132: 0.018921875, 133: 0.10815625000000001, 134: 0.0, 135: 0.149234375, 136: 2.8056875, 137: 0.289890625, 138: 2.242203125, 139: 1.2984843750000001, 140: 0.0, 141: 2.3518125000000003, 142: 0.0, 143: 0.08053125, 144: 0.0, 145: 0.0, 146: 3.0366875, 12995: 0.0, 148: 0.14782812500000003, 149: 0.63125, 150: 0.0, 151: 0.6880625, 152: 0.0, 12996: 0.0, 154: 0.33332812500000003, 155: 0.96284375, 156: 0.4543125, 157: 0.78171875, 158: 0.0490625, 159: 4.3064375, 160: 1.3221875, 161: 0.0, 162: 0.13142187500000002, 163: 0.37553125, 164: 0.0, 165: 0.643984375, 166: 0.0, 167: 0.317796875, 168: 0.0, 169: 0.316234375, 170: 0.631796875, 171: 0.4330625, 173: 0.23268750000000002, 174: 0.0, 175: 0.284625, 177: 0.01709375, 178: 0.425296875, 179: 0.0, 180: 0.5298125, 181: 0.7413906250000001, 182: 0.0, 183: 0.721265625, 184: 0.594328125, 185: 0.0, 186: 0.31725000000000003, 187: 0.58115625, 188: 0.140953125, 189: 0.22379687500000003, 190: 0.8068437500000001, 191: 0.7223906250000001, 192: 0.23704687500000002, 193: 0.0, 194: 3.673015625, 195: 0.621078125, 196: 0.1703125, 197: 0.0188125, 198: 0.0, 199: 0.70890625, 200: 0.28646875, 201: 2.967796875, 202: 1.1554531250000002, 203: 0.035046875, 204: 0.141578125, 205: 0.0, 206: 0.21235937500000002, 207: 0.03240625, 208: 0.0, 209: 0.49926562500000005, 210: 0.052859375, 211: 0.8554843750000001, 212: 4.778328125, 213: 0.0, 214: 0.37148437500000003, 215: 0.98321875, 216: 0.28003125, 217: 0.386765625, 218: 0.873453125, 219: 0.0, 220: 5.216875, 221: 0.0, 222: 0.068234375, 223: 0.272453125, 224: 0.332359375, 225: 0.514828125, 226: 1.1191250000000001, 227: 0.0, 228: 1.07496875, 229: 1.7350312500000002, 230: 0.071578125, 231: 0.030109374999999997, 232: 0.425390625, 233: 0.5909531250000001, 234: 0.3406875, 235: 0.5573125000000001, 236: 0.963328125, 237: 0.04340625000000001, 238: 0.06398437500000001, 239: 2.1271093750000003, 240: 0.21014062500000003, 241: 0.9015937500000001, 242: 3.3383125000000002, 243: 0.126578125, 244: 5.199015625, 245: 0.0, 246: 0.44548437500000004, 247: 8.0595, 248: 0.23275, 249: 0.023062500000000003, 250: 0.7692500000000001, 251: 0.73309375, 252: 0.700359375, 253: 0.0, 254: 7.72696875, 255: 0.388953125, 256: 0.5087812500000001, 257: 0.21135937500000002, 258: 2.44890625, 259: 0.10576562500000002, 260: 0.16067187500000002, 261: 0.0, 262: 1.5264843750000001, 263: 0.07075000000000001, 264: 0.0, 266: 0.12015625000000002, 267: 0.030609375000000005, 268: 0.138015625, 269: 0.183625, 270: 0.0, 271: 0.0884375, 272: 0.07278125, 274: 0.542234375, 275: 3.74571875, 276: 4.79390625, 277: 0.0, 278: 3.9871406250000008, 279: 0.031718750000000004, 280: 0.0313125, 281: 0.3025, 283: 0.0, 284: 3.765625, 285: 0.0, 286: 0.097, 287: 0.0141875, 288: 0.6685156250000001, 289: 1.2064687500000002, 290: 7.9360156250000005, 291: 4.572640625, 292: 0.06345312500000001, 293: 0.0, 294: 6.850171875000001, 295: 1.5061875, 296: 0.738515625, 297: 0.0, 298: 0.37478125, 299: 0.0, 300: 0.0, 301: 0.8172500000000001, 302: 2.59471875, 303: 0.7998125, 304: 0.44148437500000004, 305: 0.178640625, 306: 0.0, 307: 0.73784375, 308: 0.614515625, 309: 0.0, 310: 0.30790625, 311: 0.45684375, 312: 0.20907812500000003, 313: 35.341765625, 314: 0.23684375000000002, 315: 123.177171875, 316: 0.0, 317: 0.0, 318: 0.017124999999999998, 319: 1.135125, 320: 1.7746718750000001, 321: 0.021781250000000002, 322: 31.23134375, 323: 22.885546875000003, 324: 0.08373437500000001, 325: 0.099328125, 326: 2.105375, 327: 0.311515625, 328: 1.0637343750000001, 329: 10.377796875000001, 330: 0.05556250000000001, 331: 0.746984375, 332: 0.0013125, 333: 0.0995, 334: 0.8236093750000001, 335: 0.186328125, 336: 0.029656250000000002, 337: 3.262578125, 338: 0.015640625000000002, 339: 8.824359375000002, 340: 0.186578125, 341: 0.014125, 342: 3.437078125, 343: 113.366859375, 344: 0.34096875000000004, 345: 2.96596875, 346: 0.78790625, 347: 0.139578125, 348: 1.5729375, 349: 0.0, 350: 0.0325625, 351: 1.6460937500000001, 352: 0.0, 353: 1.4202031250000002, 354: 25.976390625, 355: 0.0, 356: 0.0123125, 357: 0.0, 358: 0.07321875000000001, 359: 1.00609375, 360: 0.10709375000000002, 361: 4.856796875000001, 362: 1.190671875, 363: 0.44856250000000003, 364: 0.06432812500000001, 365: 0.0, 366: 0.213609375, 367: 0.64, 368: 0.06451562500000001, 369: 5.427921875, 370: 16.1643125, 371: 0.027703125, 372: 0.008875, 373: 0.0, 374: 0.445359375, 375: 14.503765625, 376: 0.0, 377: 0.108640625, 378: 5.946593750000001, 379: 0.352171875, 380: 0.036937500000000005, 381: 1.33640625, 382: 8.58309375, 383: 0.0, 384: 0.0, 385: 6.2301875, 386: 6.177015625000001, 387: 0.0, 388: 0.005843750000000001, 389: 0.0, 390: 0.03590625000000001, 391: 2.33465625, 392: 0.0, 393: 0.01290625, 394: 1.88353125, 395: 1.567984375, 396: 0.0, 397: 0.08309375000000001, 398: 0.8351406250000001, 399: 1.504140625, 400: 0.0, 401: 0.18778125, 402: 2.0524218750000003, 403: 1.560546875, 404: 0.0, 405: 0.0, 406: 0.36184375, 407: 1.91796875, 408: 0.237859375, 409: 0.90309375, 410: 0.0, 411: 0.7068125000000001, 412: 0.738546875, 413: 0.17012500000000003, 414: 0.0745, 415: 2.8263281250000003, 416: 0.17720312500000002, 418: 0.40990625, 419: 0.0, 420: 0.0, 421: 0.114078125, 422: 0.28734375, 423: 0.6147187500000001, 424: 0.20668750000000002, 425: 0.66540625, 426: 0.3738125, 427: 1.138453125, 428: 0.0, 429: 0.888796875, 430: 0.750359375, 431: 0.151734375, 432: 0.0013125, 433: 0.49642187500000007, 434: 0.7380937500000001, 435: 0.070015625, 10676: 0.0, 437: 1.7071875, 438: 0.142796875, 439: 0.0145, 440: 0.244109375, 441: 0.091234375, 442: 0.49407812500000003, 10683: 1.9655, 444: 1.65425, 445: 0.6154843750000001, 446: 0.11264062500000001, 447: 0.00575, 448: 0.34773437500000004, 10689: 3.0264687500000003, 450: 0.5773125, 451: 0.24953125, 452: 0.185, 453: 37.1779375, 454: 0.20754687500000002, 10695: 0.29432812500000005, 456: 0.007203125, 457: 0.0, 10698: 0.27509375, 10699: 0.31798437500000004, 10700: 0.571375, 461: 0.18928125, 10702: 0.0, 463: 5.305953125, 10704: 0.737484375, 465: 1.271875, 10706: 0.0, 10707: 0.05645312500000001, 468: 0.016515625, 469: 0.013625000000000002, 470: 0.204796875, 471: 0.071359375, 10712: 0.0, 473: 1.0558906250000002, 10714: 0.0, 475: 0.8587656250000001, 476: 0.0, 477: 41.834859375, 478: 0.7595312500000001, 479: 0.3579375, 480: 0.099703125, 481: 0.269703125, 10722: 3.838718750000001, 483: 0.21784375000000003, 484: 0.2285, 485: 24.55521875, 486: 1.708703125, 487: 0.12164062500000002, 488: 0.00065625, 489: 0.04596875, 10730: 0.0, 491: 0.42342187500000006, 492: 0.0, 493: 9.54678125, 494: 0.54096875, 495: 1.593671875, 496: 0.09418750000000001, 497: 0.0, 498: 0.344796875, 499: 0.0, 500: 22.248234375, 501: 0.116078125, 502: 5.259578125000001, 503: 1.15834375, 504: 1.57428125, 505: 0.04498437500000001, 506: 0.0, 507: 18.145781250000002, 508: 0.0135, 509: 1.4259375, 510: 0.140578125, 511: 0.27787500000000004, 512: 47.604125, 513: 0.02784375, 514: 0.04278125000000001, 515: 0.230765625, 516: 0.0, 517: 0.0, 518: 3.833640625, 519: 1.2568125, 520: 0.46240625, 521: 0.06835937500000001, 522: 0.0, 523: 0.905703125, 524: 0.410421875, 525: 0.224046875, 526: 0.8478593750000001, 527: 0.3103125, 528: 44.642953125000005, 529: 0.07321875000000001, 530: 0.15215625000000002, 531: 0.10454687500000001, 532: 0.50778125, 533: 1.2225625, 534: 0.1589375, 535: 0.10709375000000002, 536: 1.2866875, 537: 0.29673437500000005, 538: 0.014718750000000001, 10671: 0.0, 540: 0.325890625, 541: 3.860953125, 542: 0.88675, 543: 0.8977343750000001, 544: 0.49168750000000006, 545: 0.0, 546: 0.015125000000000001, 547: 0.0, 548: 0.0, 549: 19.952796875, 550: 0.0, 551: 0.20440625, 552: 0.0, 553: 0.0, 554: 0.07946875, 555: 0.0, 556: 0.493484375, 557: 0.04665625, 558: 0.17564062500000002, 559: 0.59059375, 560: 0.04409375, 561: 0.0, 562: 0.05556250000000001, 10675: 2.400328125, 564: 0.7327968750000001, 565: 0.285078125, 566: 1.0987968750000001, 567: 267.98440625, 568: 0.0, 569: 0.004718750000000001, 570: 0.0, 571: 1.515453125, 572: 0.0, 573: 0.1038125, 574: 0.7139375, 575: 0.283265625, 576: 0.013453125000000002, 577: 0.5760625, 578: 0.3345, 579: 2.110625, 580: 0.122265625, 581: 0.188296875, 582: 0.31629687500000003, 583: 0.98003125, 584: 0.0, 585: 0.22725000000000004, 586: 0.0, 587: 0.084515625, 588: 0.8171875000000001, 589: 1.7340781250000001, 590: 0.68215625, 591: 0.11065625, 592: 0.0, 593: 0.8611406250000001, 594: 0.0425625, 595: 0.2363125, 596: 1.1463906250000002, 597: 1.2570781250000003, 598: 0.116875, 599: 0.394625, 600: 0.687890625, 601: 0.31825000000000003, 602: 0.030968750000000003, 603: 1.8708125000000002, 604: 0.126703125, 605: 0.47700000000000004, 606: 1.1005625, 607: 1.593953125, 608: 0.27528125, 609: 0.06996875, 610: 0.889796875, 443: 0.8074687500000001, 612: 0.8755468750000001, 613: 0.2464375, 614: 0.472109375, 615: 0.0, 616: 0.33715625000000005, 617: 0.20907812500000003, 618: 1.0317812499999999, 619: 0.386328125, 620: 0.254375, 621: 0.502265625, 622: 0.04993750000000001, 623: 51.475187500000004, 624: 0.0, 625: 1.4325, 626: 0.45210937500000004, 627: 0.0, 628: 0.155078125, 629: 1.21675, 630: 0.526578125, 631: 2.51296875, 632: 1.43046875, 633: 0.00465625, 634: 0.28559375, 635: 0.326640625, 636: 0.529484375, 637: 4.3672031250000005, 638: 0.46970312500000005, 639: 0.523515625, 640: 0.0, 10688: 0.0, 642: 0.16914062500000002, 643: 0.05334375, 644: 0.0, 645: 17.683812500000002, 646: 0.09178125, 647: 1.9894531250000003, 648: 3.60340625, 649: 0.08731250000000002, 650: 0.0, 651: 0.649328125, 652: 0.027156250000000003, 653: 0.01528125, 654: 0.16282812500000002, 655: 1.03778125, 656: 2.057125, 657: 0.7902968750000001, 658: 1.1903437500000003, 659: 0.010359375, 660: 0.0054375000000000005, 661: 0.6245625, 662: 0.07984375, 663: 0.9516718750000001, 664: 0.69375, 10692: 0.735140625, 666: 0.044078125, 667: 0.096828125, 668: 0.2858125, 669: 12.957203125000001, 670: 1.3784687500000001, 671: 0.165296875, 672: 24.55521875, 673: 0.02634375, 674: 0.02075, 675: 0.12206250000000002, 676: 0.09760937500000001, 677: 1.764796875, 678: 0.275359375, 679: 0.59096875, 680: 0.0021875, 681: 0.09493750000000001, 682: 0.257640625, 683: 1.019703125, 684: 0.12471875000000002, 685: 0.6823125, 686: 0.571328125, 687: 1.34015625, 688: 216.50921875, 689: 0.02984375, 690: 0.12925, 691: 0.3165, 692: 0.42517187500000003, 693: 0.48854687500000005, 694: 0.449359375, 695: 208.074703125, 696: 0.023203125, 697: 1.2067500000000002, 698: 43.850578125000006, 699: 0.0005, 700: 0.2408125, 458: 1.447, 702: 0.34910937500000006, 703: 7.238406250000001, 704: 0.20032812500000002, 12993: 0.0, 12994: 0.0, 707: 0.285484375, 708: 0.450328125, 12997: 0.0, 710: 0.0, 711: 0.20265625, 712: 0.09651562500000001, 713: 0.0, 714: 4.4334999999999996, 715: 0.9221250000000001, 716: 0.0, 717: 0.0, 718: 1.00553125, 719: 0.079890625, 720: 0.24700000000000003, 721: 0.8195, 722: 0.0, 723: 1.857625, 724: 0.12409375000000002, 725: 0.073609375, 726: 6.197171875, 727: 0.202609375, 728: 6.1933125, 729: 0.567484375, 730: 0.0, 731: 1.0145, 732: 0.0200625, 733: 1.462609375, 734: 0.0, 735: 0.32684375000000004, 736: 0.0, 464: 0.0059375, 738: 0.0, 739: 0.0, 740: 0.006953125, 741: 0.160421875, 742: 0.0, 743: 0.348078125, 744: 0.2939375, 745: 0.0, 746: 1.5613750000000002, 747: 0.56515625, 748: 0.09503125000000001, 749: 0.8368125, 750: 0.09217187500000001, 751: 0.0, 752: 5.12221875, 753: 0.01565625, 754: 4.0904375, 467: 3.23728125, 755: 0.6103125, 757: 0.05096875000000001, 758: 0.0, 759: 0.021109375, 760: 0.0, 761: 0.016875, 762: 0.0, 763: 0.01740625, 764: 0.977421875, 765: 0.052187500000000005, 766: 0.0, 767: 3.1835156250000005, 768: 6.82259375, 769: 0.14104687500000002, 770: 0.0, 771: 16.207015625, 772: 0.57859375, 773: 0.31459375, 774: 0.27071875, 775: 0.0, 776: 8.3196875, 777: 0.1251875, 778: 1.633453125, 779: 0.0, 780: 0.31334375000000003, 781: 0.02021875, 782: 0.0, 783: 0.21710937500000002, 784: 6.000500000000001, 472: 0.15246875000000001, 786: 0.16045312500000003, 787: 0.0, 788: 0.62175, 789: 0.0, 790: 0.0, 791: 0.06484375, 792: 1.2495312500000002, 793: 0.353625, 794: 1.7208750000000002, 795: 5.1662187500000005, 796: 0.0, 797: 2.157640625, 798: 0.26309375, 799: 0.0, 800: 0.36771875000000004, 801: 0.0, 802: 0.43915625, 803: 9.640328125000002, 804: 0.05865625000000001, 805: 0.21256250000000002, 806: 1.475953125, 807: 0.0, 808: 0.0, 809: 1.6602812500000002, 810: 0.273359375, 811: 1.706390625, 812: 0.2856875, 813: 0.0, 814: 0.323671875, 815: 0.0, 816: 0.32025000000000003, 817: 0.0, 818: 2.1007031250000003, 819: 0.045062500000000005, 820: 1.1800937500000002, 821: 1.7901718750000002, 822: 20.237843750000003, 823: 0.0, 824: 0.99015625, 825: 0.0, 826: 2.0674843750000003, 827: 0.47725000000000006, 828: 2.985234375, 829: 0.23126562500000003, 830: 0.508140625, 831: 0.0111875, 832: 1.1863750000000002, 10720: 3.0273750000000006, 834: 0.816671875, 835: 3.8118593750000005, 836: 0.714828125, 837: 0.27390625, 838: 0.3983125, 839: 0.09378125000000001, 840: 5.242375, 841: 0.8420000000000001, 842: 1.252703125, 843: 1.0478125, 844: 2.33653125, 845: 0.920765625, 846: 0.2859375, 847: 0.7877812500000001, 848: 1.7566875, 849: 0.065453125, 850: 0.0, 851: 0.5253437500000001, 852: 1.615328125, 853: 0.7886093750000001, 854: 1.477, 855: 0.0, 856: 11.747484375, 857: 0.37095312500000005, 858: 0.0, 859: 0.025390625000000003, 860: 0.14721875, 861: 0.48782812500000006, 862: 1.295359375, 10725: 1.4213593750000002, 864: 6.400375, 865: 0.250828125, 866: 1.2759375, 867: 0.8761562500000001, 868: 0.061281249999999995, 869: 0.074515625, 870: 2.557203125, 871: 0.0, 872: 0.173328125, 873: 0.7115000000000001, 874: 0.063640625, 875: 0.06992187500000001, 876: 0.0, 877: 0.24825000000000003, 878: 0.357515625, 879: 2.7197656250000004, 880: 0.09254687500000001, 881: 0.4789843750000001, 882: 0.33406250000000004, 883: 0.10907812500000001, 884: 0.17787500000000003, 885: 0.0, 886: 4.0595625, 887: 0.0, 888: 0.45120312500000004, 889: 0.27498437500000006, 890: 0.237609375, 891: 0.091484375, 892: 0.0, 893: 0.30740625000000005, 894: 0.947640625, 895: 3.457703125, 896: 0.29340625000000004, 897: 0.304609375, 898: 0.6564531250000001, 899: 0.025593750000000002, 900: 1.2006562500000002, 901: 2.35096875, 902: 0.193546875, 903: 0.27371875, 904: 1.8791875000000002, 905: 0.552796875, 756: 0.11501562500000001, 907: 0.20139062500000002, 908: 0.19240625000000003, 909: 11.881359375, 910: 0.12120312500000001, 10733: 0.0, 912: 0.09715625000000001, 913: 0.0, 914: 0.003875, 915: 0.212015625, 916: 0.41675, 10734: 0.8715156250000001, 918: 8.57578125, 919: 0.400546875, 920: 4.011359375, 921: 0.8765000000000001, 922: 1.4531093750000001, 10735: 0.6273125, 924: 2.214875, 182305693: 0.0, 926: 3.0865468750000002, 927: 0.0505625, 928: 6.866093750000001, 10736: 0.0, 930: 0.5001406250000001, 931: 0.7925, 932: 1.2495312500000002, 182305701: 0.0, 934: 0.21903125, 935: 0.745796875, 936: 2.675203125, 182305705: 0.0, 938: 0.9124062500000001, 939: 0.032984375, 940: 0.61475, 182305709: 0.0, 942: 2.6913906250000004, 943: 3.9456875, 944: 0.3776875, 182305713: 0.0, 946: 0.73275, 947: 0.0, 948: 2.4601875, 949: 0.02828125, 950: 0.30675, 951: 0.7024218750000001, 952: 2.1543593750000003, 953: 0.0, 954: 0.43371875, 955: 0.5128125, 956: 3.22165625, 957: 1.6539531250000001, 958: 0.53509375, 959: 0.348875, 960: 11.609468750000001, 961: 13.132171875000001, 962: 3.309296875, 963: 0.032703125, 964: 0.0, 965: 0.26942187500000003, 966: 0.5370312500000001, 967: 14.806312500000002, 968: 1.2999375000000002, 969: 0.341859375, 970: 0.21482812500000004, 971: 0.45875000000000005, 972: 1.78546875, 973: 0.254984375, 974: 0.8192656250000001, 975: 0.04603125, 976: 4.011359375, 977: 0.454453125, 978: 0.697578125, 979: 0.0, 980: 0.08175, 981: 1.0343593750000002, 982: 0.07070312499999999, 983: 14.613593750000001, 984: 2.6885000000000003, 985: 11.994359375000002, 986: 0.13762500000000003, 987: 6.229843750000001, 988: 1.0436875, 989: 0.381515625, 990: 0.29292187500000005, 991: 7.81275, 992: 0.0, 993: 10.253875, 994: 0.0, 995: 0.0, 996: 0.504890625, 997: 478.54526562500007, 998: 0.384078125, 999: 0.16978125000000002, 1000: 0.74775, 1001: 0.0, 1002: 2.7210781250000005, 1003: 0.0, 1004: 0.08803125, 1005: 0.119390625, 1006: 0.51665625, 1007: 5.437921875000001, 1008: 1.4905625, 1009: 49.589875, 1010: 0.18185937500000002, 1011: 2.5548125, 1012: 0.0, 1014: 0.543671875, 1015: 0.7173750000000001, 1016: 2.93103125, 1017: 9.387390625000002, 1018: 2.5908437500000003, 1019: 0.0, 1020: 1.117953125, 1021: 1.581953125, 1022: 1.772203125, 1023: 0.759453125, 1024: 0.0, 1025: 3.3886406250000003, 1026: 0.21004687500000002, 1027: 0.19276562500000002, 1028: 0.0, 1029: 0.15146875, 1030: 0.345375, 1031: 0.3285, 1032: 0.0, 1033: 1.8866562500000001, 1034: 0.402328125, 1035: 0.711359375, 1036: 0.0, 1037: 0.8062812500000001, 1038: 2.1609843750000004, 1039: 0.04434375, 1040: 0.0, 10673: 0.0, 1042: 0.42067187500000003, 1043: 0.0, 1044: 0.110796875, 1045: 0.10628125000000001, 1046: 0.326640625, 1047: 1.3687187500000002, 1048: 3.0295468750000003, 1049: 1.3758281250000002, 1050: 0.32962500000000006, 1051: 0.0, 785: 0.2054375, 1053: 0.0, 1054: 0.39281250000000006, 1055: 0.0, 1056: 5.4050625, 1057: 2.18296875, 1058: 0.44053125000000004, 1059: 0.10445312500000001, 1060: 0.04440625, 1061: 0.06553125, 1062: 0.38860937500000003, 1063: 0.0, 1064: 3.9823281250000004, 1065: 42.183406250000004, 1066: 0.478953125, 1067: 0.23431250000000003, 1068: 0.0, 1069: 0.061203125, 1070: 2.457328125, 10674: 3.167984375, 1072: 0.2088125, 1073: 26.959140625, 1074: 0.2748125, 1075: 0.16323437500000001, 1076: 0.0, 1077: 0.022218750000000002, 1078: 0.0, 1079: 0.462453125, 1080: 20.809109375, 1081: 0.07276562500000001, 1082: 0.07945312500000001, 863: 0.49950000000000006, 1084: 1.2428125, 1085: 0.121984375, 1086: 0.531859375, 1087: 0.0, 1088: 0.1875, 1089: 41.046953125, 1090: 1.4450156250000001, 1091: 6.866093750000001, 1092: 0.27993750000000006, 1093: 3.2647656250000003, 1094: 0.30334375, 1095: 0.0, 1096: 0.37278125, 1097: 15.888890625, 1098: 0.520015625, 1099: 5.0203125, 1100: 1.6723125, 1101: 0.640984375, 1102: 0.584953125, 1103: 0.0, 1104: 0.10165625, 1105: 0.20265625, 1106: 0.401390625, 1107: 1.0479687500000001, 1108: 0.63075, 1109: 0.028953125, 1110: 0.157796875, 1111: 1.2711875, 1112: 0.0, 1113: 0.080453125, 1114: 0.228296875, 1116: 0.08878125, 1117: 4.106203125, 1118: 0.06625, 1119: 0.0, 1120: 0.049546875000000004, 1121: 1.722421875, 1123: 1.0104062500000002, 1124: 0.0, 1125: 0.27353125, 1126: 0.013390625, 1127: 0.9574843750000002, 1128: 0.914765625, 1129: 35.8416875, 1131: 0.0, 1132: 3.717046875, 1133: 0.001828125, 1139: 0.087640625, 1140: 0.38956250000000003, 1141: 0.25067187500000004, 1142: 0.45856250000000004, 1143: 0.0, 1144: 0.0, 1145: 0.0, 10708: 0.5881718750000001, 10677: 3.004734375, 539: 0.0, 10728: 0.216328125, 10678: 1.812734375, 449: 0.22431250000000003, 10679: 0.0, 12998: 0.0, 10680: 2.1695937499999998, 705: 0.014156250000000002, 10710: 0.7346875, 10715: 0.0, 10682: 0.0, 563: 0.0, 10729: 0.33896875000000004, 906: 0.210484375, 10711: 1.262921875, 10681: 1.423140625, 10684: 0.889421875, 10727: 0.0, 455: 0.027031250000000003, 10685: 0.0, 917: 0.04340625000000001, 10721: 0.0, 1041: 5.4827031250000005, 10716: 0.0, 923: 0.0, 1071: 0.0, 925: 0.0, 10687: 2.456234375, 929: 0.059328125, 1052: 0.48359375, 459: 0.0, 933: 2.6855937500000002, 937: 0.0, 460: 0.083578125, 10723: 1.2538437500000001, 941: 0.0, 10690: 0.6406875000000001, 945: 1.1550000000000002, 10717: 0.0, 10691: 0.0, 482: 0.4231875, 153: 0.0, 462: 0.0, 706: 0.07834375, 611: 0.034375, 147: 0.05065625, 10731: 0.36345312500000004, 10693: 0.189296875, 911: 0.0, 182305697: 0.0, 737: 0.34718750000000004, 182305689: 0.0, 701: 2.5563125, 10694: 0.5641875000000001, 466: 1.6183750000000001, 10726: 0.16135937500000003, 10672: 2.2699375, 10718: 0.0, 10696: 0.21676562500000002, 10697: 0.314421875, 10732: 0.7824375000000001, 641: 0.0, 1083: 0.7098437500000001, 304325711: 0.0, 10724: 0.0, 10719: 0.0, 10701: 0.35345312500000003, 833: 0.0, 10709: 0.0, 490: 0.0, 10703: 4.02921875, 665: 1.0959687500000002, 474: 0.0, 10686: 0.997234375, 10705: 0.040703125, 10713: 1.4255781250000001, 436: 0.34718750000000004, 10737: 0.672625, 709: 2.468140625}
id_to_color     = {}
region_to_color = {}
json_layers = []

def getRequestRegion(excluded_regions, included_regions, specie):
    request = "SELECT id, name, full_name, color, parent, is_leaf from regions where specie='" + specie + "' "
    if len(excluded_regions)>0 or len(included_regions >0):
        request+=("AND full_name not like '%"+("%' AND full_name not like '%").join(excluded_regions) + "%' ") if len(excluded_regions)>0 else ""
        request+=("AND (full_name like '%"+("%' OR full_name like '%").join(included_regions) + "%') ") if len(included_regions)>0 else ""
    request+= "ORDER BY id ASC"
    # print(request)
    return request

def get_regions(cursor, excluded_regions, included_regions, specie):
    global json_layers, region_keys, regKeys, regions_ALLNAME_list
    iterTMP = 0
    request = getRequestRegion(excluded_regions, included_regions, specie)
    cursor.execute(request)
    rows = cursor.fetchall()
    json_layers = np.zeros(rows[-1][0]+1, dtype=np.int8)
    for line in rows:
        id_to_region_dictionary[line[0]] = line[1]
        id_to_region_dictionary_ALLNAME[line[0]] = line[2]
        region_dictionary_to_id[line[1]] = line[0]
        region_dictionary_to_id_ALLNAME[line[2]] = line[0]

        region_dictionary_to_id_ALLNAME_parent[line[2]] = line[2].rsplit("|", 1)[1] 
        region_dictionary_to_id_parent[line[1]] = line[2].rsplit("|", 2)[1]
        allname2name [line[2]]= line[1]
        name2allname [line[1]] = line[2]
        allnameOrder [line[2]] = iterTMP; iterTMP+=1
        region_keys.append(line[1])
        regions_ALLNAME_list.append(line[2])
        is_leaf.append(line[5])
        id_to_color[line[0]] = line[3]
        region_to_color[line[1]] = line[3]

        if line[2].find("Isocortex")>=0:
            if line[2].find("ayer 1")>=0:   json_layers[line[0]] = 1;
            elif line[2].find("ayer 2")>=0: json_layers[line[0]] = 2;
            elif line[2].find("ayer 3")>=0: json_layers[line[0]] = 2;
            elif line[2].find("ayer 4")>=0: json_layers[line[0]] = 4;
            elif line[2].find("ayer 5")>=0: json_layers[line[0]] = 5;
            elif line[2].find("ayer 6")>=0: json_layers[line[0]] = 6;
            else:                           json_layers[line[0]] = 0;
        else:
            json_layers[line[0]] = 0;
    regKeys = region_dictionary_to_id_ALLNAME.keys()

dict_corrections = {}
old_regions_layer23 = [  41,  113,  163,  180,  201,  211,  219,  241,  251,  269,  288,
        296,  304,  328,  346,  412,  427,  430,  434,  492,  556,  561,
        582,  600,  643,  657,  667,  670,  694,  755,  806,  821,  838,
        854,  888,  905,  943,  962,  965,  973, 1053, 1066, 1106, 1127, 12994, 182305697 ]
for reg in old_regions_layer23:
    dict_corrections[reg] = [reg +20000, reg+30000]

dict_corrections[195] = [20304]
dict_corrections[747] = [20556]
dict_corrections[524] = [20582]
dict_corrections[606] = [20430]

inv_corrections = {}
for k,v in dict_corrections.items():
    for conv in v:
        inv_corrections[conv] = k
